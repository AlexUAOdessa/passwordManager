package crypto

// Manager управляет ключами в памяти
type Manager struct {
    masterKey []byte
}

func NewManager(password string, salt []byte) *Manager {
    return &Manager{
        masterKey: deriveKey(password, salt),
    }
}

// Теперь методы шифрования привязаны к менеджеру
func (m *Manager) Encrypt(data []byte) ([]byte, error) { ... }